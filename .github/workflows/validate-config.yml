name: Validate Configuration

on:
  push:
    paths:
      - '.env.*'
      - 'config/**'
      - 'src/config/**'
  pull_request:
    paths:
      - '.env.*'
      - 'config/**'
      - 'src/config/**'
  workflow_dispatch:

jobs:
  validate:
    name: Validate Configuration
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      - name: Install Dependencies
        run: npm ci

      - name: Validate Configuration
        run: npm run validate:config
        env:
          # Sample environment variables for validation
          NODE_ENV: test
          APP_VERSION: 1.0.19
          LOG_LEVEL: info
          DEBUG: false
          STRIPE_SECRET_KEY: sk_test_example
          STRIPE_PUBLISHABLE_KEY: pk_test_example
          STRIPE_WEBHOOK_SECRET: whsec_example
          STRIPE_PRICE_PERSONAL_MONTHLY: price_example
          STRIPE_PRICE_PERSONAL_YEARLY: price_example
          STRIPE_PRICE_PROFESSIONAL_MONTHLY: price_example
          STRIPE_PRICE_PROFESSIONAL_YEARLY: price_example
          STRIPE_PRICE_TEAM_MONTHLY: price_example
          STRIPE_PRICE_TEAM_YEARLY: price_example
          STRIPE_PRODUCT_BETA_ACCESS: prod_example
          STRIPE_PRICE_BETA_EARLYBIRD: price_example
          STRIPE_PRICE_BETA_ACCESS: price_example
          STRIPE_PRICE_BETA_PREMIUM: price_example
          TELEMETRY_ENDPOINT: https://example.com/telemetry
          TELEMETRY_API_KEY: test_key
          ANALYTICS_ENDPOINT: https://example.com/analytics
          ANALYTICS_API_KEY: test_key
          SENTRY_DSN: https://example.com/sentry
          APPINSIGHTS_INSTRUMENTATIONKEY: test_key
          APPLICATIONINSIGHTS_CONNECTION_STRING: test_key
          APPINSIGHTS_ENDPOINT: https://example.com/insights
          GA_MEASUREMENT_ID: test_id
          GA_API_SECRET: test_secret
          PRICING_URL: https://example.com/pricing
