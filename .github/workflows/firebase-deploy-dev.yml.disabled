name: ğŸ”¥ Firebase Deploy (Development)

on:
  # Only run on manual trigger to save Actions minutes
  workflow_dispatch:
    inputs:
      skip_build:
        description: 'Skip build step (if already built)'
        required: false
        default: false
        type: boolean
      deploy_message:
        description: 'Custom deployment message'
        required: false
        default: 'Development deployment'

jobs:
  firebase-deploy-dev:
    name: ğŸ”¥ Quick Deploy to Firebase
    runs-on: ubuntu-latest
    
    steps:
      - name: ğŸ“¦ Checkout code
        uses: actions/checkout@v4

      - name: âš™ï¸ Install Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20
          cache: npm

      - name: ğŸ“ Install dependencies (cached)
        run: npm ci --prefer-offline --no-audit

      - name: ğŸ› ï¸ Build app
        if: ${{ !inputs.skip_build }}
        run: npm run build:web

      - name: ğŸ§œâ€â™€ï¸ Firebase Deploy
        env:
          FIREBASE_TOKEN: ${{ secrets.FIREBASE_TOKEN }}
        run: |
          npm install -g firebase-tools
          firebase deploy --only hosting --message "${{ inputs.deploy_message }}" --project rinawarp-terminal

      - name: âœ¨ Deployment Status
        run: |
          echo "ğŸŒŠ ${{ inputs.deploy_message }} complete!"
          echo "ğŸ”— Live at: https://rinawarp-terminal.web.app"
